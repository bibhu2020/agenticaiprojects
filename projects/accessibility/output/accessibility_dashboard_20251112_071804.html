<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessibility Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  .pass { color: #16a34a; }
  .fail { color: #dc2626; }
  .warning { color: #f59e0b; }
  .summary-card { cursor: pointer; }
</style>
</head>
<body class="bg-gray-100 font-sans">
<header class="bg-blue-600 text-white p-6 shadow-md sticky top-0 z-50">
  <h1 class="text-3xl font-bold" id="site-name">Site Accessibility Dashboard</h1>
  <p class="mt-2" id="summary">
    Summary: All Pages
    | Passed: <span id="total-pass">0</span>
    | Failed: <span id="total-fail">0</span>
    | Warnings: <span id="total-warning">0</span>
  </p>
</header>

<!-- Page Summary Cards -->
<div class="flex flex-wrap gap-4 px-6 mb-4" id="summary-cards"></div>

<!-- Filters -->
<div class="flex space-x-4 mb-4 px-6">
  <button class="filter-btn px-4 py-2 bg-gray-300 rounded" data-filter="all">All</button>
  <button class="filter-btn px-4 py-2 bg-green-300 rounded" data-filter="pass">Passed</button>
  <button class="filter-btn px-4 py-2 bg-red-300 rounded" data-filter="fail">Failed</button>
  <button class="filter-btn px-4 py-2 bg-yellow-300 rounded" data-filter="warning">Warnings</button>
</div>

<!-- Audit Tables -->
<div id="audit-tables" class="px-6 space-y-4"></div>

<!-- Scroll-to-top button -->
<button id="scrollTopBtn" 
        class="fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow-lg hover:bg-blue-700 transition-opacity opacity-75 hover:opacity-100">
  â†‘ Top
</button>

<!-- Inject audit data as JSON -->
<script>
const auditData = [{"page": "https://oauthapp.azurewebsites.net/", "rows": [{"level": "", "rule": "Level", "status": "Rule", "reason": "Pass/Fail", "recommendation": "Reason"}, {"level": "", "rule": ":----", "status": ":-----------------------", "reason": ":--------", "recommendation": ":-------------------------------------------------------------------------------------------------------------------------"}, {"level": "", "rule": "A", "status": "Document Title", "reason": "Pass", "recommendation": "The document has a non-empty `<title>` element."}, {"level": "", "rule": "A", "status": "HTML has lang", "reason": "Pass", "recommendation": "The `<html>` element has a lang attribute."}, {"level": "", "rule": "A", "status": "HTML lang valid", "reason": "Pass", "recommendation": "The lang attribute of the `<html>` element has a valid value."}, {"level": "", "rule": "A", "status": "Image alt", "reason": "Pass", "recommendation": "All `<img>` elements have alternate text or a role of none or presentation."}, {"level": "", "rule": "A", "status": "Link name", "reason": "Pass", "recommendation": "All links have discernible text."}, {"level": "", "rule": "A", "status": "List", "reason": "Pass", "recommendation": "Lists are structured correctly."}, {"level": "", "rule": "A", "status": "Listitem", "reason": "Pass", "recommendation": "`<li>` elements are used semantically."}, {"level": "", "rule": "AA", "status": "Meta viewport", "reason": "Pass", "recommendation": "`<meta name=\"viewport\">` does not disable text scaling and zooming."}, {"level": "", "rule": "A", "status": "Bypass", "reason": "Pass", "recommendation": "Each page has at least one mechanism for a user to bypass navigation and jump straight to the content."}, {"level": "", "rule": "AA", "status": "Color contrast", "reason": "Pass", "recommendation": "The contrast between foreground and background colors meets WCAG 2 AA minimum contrast ratio thresholds."}, {"level": "", "rule": "A", "status": "ARIA hidden body", "reason": "Pass", "recommendation": "`aria-hidden=\"true\"` is not present on the document body."}, {"level": "", "rule": "A", "status": "ARIA hidden focus", "reason": "Pass", "recommendation": "ARIA-hidden elements are not focusable and do not contain focusable elements"}, {"level": "", "rule": "A", "status": "Button name", "reason": "Pass", "recommendation": "Ensures buttons have discernible text"}, {"level": "", "rule": "A", "status": "Nested interactive", "reason": "Pass", "recommendation": "Ensures interactive controls are not nested"}, {"level": "", "rule": "A", "status": "Scrollable region focusable", "reason": "Pass", "recommendation": "Ensures elements that have scrollable content are accessible by keyboard"}, {"level": "", "rule": "N/A", "status": "role-img-missing-name", "reason": "Fail", "recommendation": "The `<img>` elements with a role of \"img\" are missing accessible names."}, {"level": "", "rule": "N/A", "status": "duplicate-id", "reason": "Fail", "recommendation": "There are two elements with the id \"docIcon\""}], "summary": {"pass": 1, "fail": 0, "warning": 0}}, {"page": "https://oauthapp.azurewebsites.net/code", "rows": [{"level": "", "rule": "Level", "status": "Rule", "reason": "Pass/Fail", "recommendation": "Reason"}, {"level": "", "rule": ":----", "status": ":-----------------------------------------------------------", "reason": ":--------", "recommendation": ":------------------------------------------------------------------"}, {"level": "", "rule": "A", "status": "`<ul>` and `<ol>` must only directly contain `<li>`, `<script>` or `<template>` elements", "reason": "Fail", "recommendation": "List element has direct children that are not allowed: `<pre>`"}, {"level": "", "rule": "A", "status": "ARIA commands must have an accessible name", "reason": "Fail", "recommendation": "role img missing name"}, {"level": "", "rule": "N/A", "status": "duplicate-id", "reason": "Fail", "recommendation": "Duplicate ID \"docIcon\""}, {"level": "", "rule": "Area", "status": "Status", "reason": "Issues", "recommendation": ""}, {"level": "", "rule": ":------------", "status": ":-----", "reason": ":-----", "recommendation": ""}, {"level": "", "rule": "Headings", "status": "Pass", "reason": "No H1, but headings are present.  Consider adding an H1 for better document structure.", "recommendation": ""}, {"level": "", "rule": "Language", "status": "Pass", "reason": "Language attribute is present.", "recommendation": ""}, {"level": "", "rule": "Images", "status": "Pass", "reason": "No missing alt text.", "recommendation": ""}, {"level": "", "rule": "Forms", "status": "Pass", "reason": "No missing labels.", "recommendation": ""}, {"level": "", "rule": "ARIA", "status": "Fail", "reason": "Several role-img-missing-name issues and duplicate IDs. See above table for fixes.", "recommendation": ""}, {"level": "", "rule": "Keyboard", "status": "Pass", "reason": "Focusable elements are in logical tab order.", "recommendation": ""}, {"level": "", "rule": "Videos", "status": "Pass", "reason": "No videos found.", "recommendation": ""}, {"level": "", "rule": "Contrast", "status": "Pass", "reason": "No contrast issues found.", "recommendation": ""}, {"level": "", "rule": "Semantics", "status": "Pass", "reason": "Landmarks are properly used.", "recommendation": ""}], "summary": {"pass": 8, "fail": 1, "warning": 0}}, {"page": "https://oauthapp.azurewebsites.net/credential", "rows": [{"level": "", "rule": "Level", "status": "Rule", "reason": "Pass/Fail", "recommendation": "Reason"}, {"level": "", "rule": "---", "status": "---", "reason": "---", "recommendation": "---"}, {"level": "", "rule": "A", "status": "List structure", "reason": "Fail", "recommendation": "`<ol>` element has `pre` element as a direct child, which is not allowed."}, {"level": "", "rule": "A/AA", "status": "ARIA", "reason": "Fail", "recommendation": "Some `role=\"img\"` elements are missing accessible names."}, {"level": "", "rule": "A", "status": "Headings", "reason": "N/A", "recommendation": "The page does not have an H1"}, {"level": "", "rule": "A/AA", "status": "Duplicate IDs", "reason": "N/A", "recommendation": "The page has duplicate IDs."}, {"level": "", "rule": "A/AA", "status": "Image Alt Text", "reason": "Pass", "recommendation": "All images have alt text."}, {"level": "", "rule": "A/AA", "status": "Color Contrast", "reason": "Pass", "recommendation": "All elements have sufficient color contrast."}, {"level": "", "rule": "A", "status": "Link Name", "reason": "Pass", "recommendation": "All links have discernible text."}, {"level": "", "rule": "A", "status": "HTML Lang", "reason": "Pass", "recommendation": "The `<html>` element has a valid `lang` attribute."}, {"level": "", "rule": "A", "status": "Document Title", "reason": "Pass", "recommendation": "The document has a non-empty `<title>` element."}, {"level": "", "rule": "A", "status": "Bypass Blocks", "reason": "Pass", "recommendation": "The page has a mechanism to bypass repeated blocks."}, {"level": "", "rule": "AA", "status": "Meta Viewport", "reason": "Pass", "recommendation": "The `<meta name=\"viewport\">` tag does not disable text scaling and zooming."}, {"level": "", "rule": "A/AA", "status": "Keyboard Access", "reason": "N/A", "recommendation": "The page has a scrollable region that contains focusable elements."}, {"level": "", "rule": "A/AA", "status": "ARIA", "reason": "N/A", "recommendation": "Some elements with `aria-hidden=\"true\"` are focusable or contain focusable elements"}, {"level": "", "rule": "A/AA", "status": "Button Name", "reason": "Pass", "recommendation": "All buttons have discernible text"}], "summary": {"pass": 1, "fail": 0, "warning": 0}}, {"page": "https://oauthapp.azurewebsites.net/implicit", "rows": [{"level": "", "rule": "Level", "status": "Rule", "reason": "Pass/Fail", "recommendation": "Reason"}, {"level": "", "rule": "---", "status": "---", "reason": "---", "recommendation": "---"}, {"level": "", "rule": "A", "status": "List Structure", "reason": "Fail", "recommendation": "`<ol>` element contains a `<pre>` element directly, which is not allowed."}, {"level": "", "rule": "A", "status": "List Structure", "reason": "Pass", "recommendation": "`<ul>` and `<ol>` must only directly contain `<li>`, `<script>` or `<template>` elements"}, {"level": "", "rule": "A", "status": "List Items", "reason": "Pass", "recommendation": "`<li>` elements must be contained in a `<ul>` or `<ol>`"}, {"level": "", "rule": "AA", "status": "Color Contrast", "reason": "Pass", "recommendation": "The contrast between foreground and background colors meets WCAG 2 AA minimum contrast ratio thresholds"}, {"level": "", "rule": "A", "status": "Document Title", "reason": "Pass", "recommendation": "Each HTML document contains a non-empty `<title>` element"}, {"level": "", "rule": "A", "status": "HTML Lang Attribute", "reason": "Pass", "recommendation": "Every HTML document has a `lang` attribute"}, {"level": "", "rule": "A", "status": "HTML Lang Attribute Value", "reason": "Pass", "recommendation": "The `lang` attribute of the `<html>` element has a valid value"}, {"level": "", "rule": "A", "status": "Image Alt Text", "reason": "Pass", "recommendation": "`<img>` elements have alternate text or a role of none or presentation"}, {"level": "", "rule": "A", "status": "Link Name", "reason": "Pass", "recommendation": "Links have discernible text"}, {"level": "", "rule": "AA", "status": "Meta Viewport", "reason": "Pass", "recommendation": "`<meta name=\"viewport\">` does not disable text scaling and zooming"}, {"level": "", "rule": "A", "status": "Bypass Blocks", "reason": "Pass", "recommendation": "Each page has at least one mechanism for a user to bypass navigation and jump straight to the content"}, {"level": "", "rule": "N/A", "status": "Nested Interactive Elements", "reason": "Pass", "recommendation": "Interactive controls are not nested"}, {"level": "", "rule": "N/A", "status": "Scrollable Region Focusable", "reason": "Pass", "recommendation": "Elements that have scrollable content are accessible by keyboard"}, {"level": "", "rule": "N/A", "status": "ARIA", "reason": "Fail", "recommendation": "`role=img` elements are missing accessible names"}, {"level": "", "rule": "N/A", "status": "ARIA", "reason": "Fail", "recommendation": "Duplicate IDs"}, {"level": "", "rule": "N/A", "status": "Headings", "reason": "Pass", "recommendation": "Heading checks passed"}, {"level": "", "rule": "N/A", "status": "Language", "reason": "Pass", "recommendation": "Language checks passed"}, {"level": "", "rule": "N/A", "status": "Images", "reason": "Pass", "recommendation": "Image checks passed"}, {"level": "", "rule": "N/A", "status": "Forms", "reason": "Pass", "recommendation": "Forms checks passed"}, {"level": "", "rule": "N/A", "status": "Keyboard", "reason": "Pass", "recommendation": "Keyboard checks passed"}, {"level": "", "rule": "N/A", "status": "Videos", "reason": "Pass", "recommendation": "Video checks passed"}, {"level": "", "rule": "N/A", "status": "Contrast", "reason": "Pass", "recommendation": "Contrast checks passed"}, {"level": "", "rule": "N/A", "status": "Semantics", "reason": "Pass", "recommendation": "Semantic checks passed"}], "summary": {"pass": 1, "fail": 0, "warning": 0}}, {"page": "https://oauthapp.azurewebsites.net/password", "rows": [{"level": "", "rule": "Level", "status": "Rule", "reason": "Pass/Fail", "recommendation": "Reason"}, {"level": "", "rule": "---", "status": "---", "reason": "---", "recommendation": "---"}, {"level": "", "rule": "A", "status": "1.3.1: Info and Relationships", "reason": "Fail", "recommendation": "The `<ol>` element contains a `<pre>` element directly, which is not allowed."}, {"level": "", "rule": "A", "status": "4.1.2: Name, Role, Value", "reason": "Fail", "recommendation": "ARIA attributes are used to define a role of `img` but there is no accessible name provided."}, {"level": "", "rule": "A", "status": "4.1.2: Name, Role, Value", "reason": "Fail", "recommendation": "Duplicate ID."}, {"level": "", "rule": "A", "status": "1.1.1: Non-text Content", "reason": "N/A", "recommendation": "Some `<img>` elements with `role=\"img\"` are missing alternative text."}], "summary": {"pass": 0, "fail": 0, "warning": 0}}];
const tableRows = [];
const pageTables = {};
const buttons = document.querySelectorAll(".filter-btn");

// Functions
function addRow(page, level, rule, status, reason, recommendation) {
  if(!pageTables[page]) {
    const container = document.getElementById("audit-tables");
    const header = document.createElement("div");
    header.className = "bg-gray-200 px-4 py-2 rounded cursor-pointer shadow";
    header.innerHTML = `<h2 class="font-bold">${page}</h2>`;
    const tableDiv = document.createElement("div");
    tableDiv.className = "overflow-x-auto mt-2 hidden";
    const table = document.createElement("table");
    table.className = "min-w-full bg-white shadow rounded";
    table.innerHTML = `
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2">Level</th>
          <th class="px-4 py-2">Rule</th>
          <th class="px-4 py-2">Pass/Fail</th>
          <th class="px-4 py-2">Reason</th>
          <th class="px-4 py-2">Recommendation</th>
        </tr>
      </thead>
      <tbody></tbody>
    `;
    tableDiv.appendChild(table);
    container.appendChild(header);
    container.appendChild(tableDiv);
    header.addEventListener("click", () => tableDiv.classList.toggle("hidden"));
    pageTables[page] = table.querySelector("tbody");
  }

  const tbody = pageTables[page];
  const tr = document.createElement("tr");
  tr.className = "border-b";
  tr.dataset.status = status.toLowerCase();
  tr.dataset.page = page;
  tr.innerHTML = `
    <td class="px-4 py-2">${level}</td>
    <td class="px-4 py-2">${rule}</td>
    <td class="px-4 py-2 ${status.toLowerCase()}">${status}</td>
    <td class="px-4 py-2">${reason}</td>
    <td class="px-4 py-2">${recommendation}</td>
  `;
  tableRows.push(tr);
  tbody.appendChild(tr);
}

function addSummaryCard(page, passed, failed, warning) {
  const container = document.getElementById("summary-cards");
  const total = passed + failed + warning;
  const passRatio = total>0?passed/total:0;
  let colorClass="bg-green-400";
  if(passRatio<0.3) colorClass="bg-red-500";
  else if(passRatio<0.7) colorClass="bg-yellow-400";
  const passPercent = total>0?(passed/total*100):0;
  const failPercent = total>0?(failed/total*100):0;
  const warnPercent = total>0?(warning/total*100):0;

  const card = document.createElement("div");
  card.className="summary-card bg-white shadow p-4 rounded w-64 hover:shadow-lg";
  card.innerHTML=`
    <div class="flex justify-between items-center mb-2">
      <h3 class="font-bold text-lg">${page}</h3>
      <span class="px-2 py-1 text-white rounded ${colorClass}">Pass: ${passPercent.toFixed(0)}%</span>
    </div>
    <div class="flex h-3 mb-2 w-full rounded overflow-hidden shadow-inner">
      <div class="bg-green-500 h-full" style="width:${passPercent}%;"></div>
      <div class="bg-red-600 h-full" style="width:${failPercent}%;"></div>
      <div class="bg-yellow-400 h-full" style="width:${warnPercent}%;"></div>
    </div>
    <div class="text-sm">
      <p class="text-green-600">Passed: ${passed}</p>
      <p class="text-red-600">Failed: ${failed}</p>
      <p class="text-yellow-500">Warnings: ${warning}</p>
    </div>
  `;
  card.addEventListener("click", ()=>{
    const row = tableRows.find(r=>r.dataset.page===page);
    if(row) row.scrollIntoView({behavior:"smooth", block:"start"});
  });
  container.appendChild(card);
}

function updateTable(filter){
  Object.values(pageTables).forEach(tbody=>{
    Array.from(tbody.children).forEach(row=>{
      if(filter==="all"||row.dataset.status===filter) row.style.display="";
      else row.style.display="none";
    });
  });
}

buttons.forEach(btn=>{
  btn.addEventListener("click",()=>updateTable(btn.dataset.filter));
});

// Scroll to top
const scrollBtn=document.getElementById("scrollTopBtn");
scrollBtn.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}));
window.addEventListener("scroll",()=>{scrollBtn.style.display=window.scrollY>200?"block":"none";});
scrollBtn.style.display="none";

// Update totals in hero banner
function updateTotals(passed, failed, warning){
  document.getElementById("total-pass").innerText=passed;
  document.getElementById("total-fail").innerText=failed;
  document.getElementById("total-warning").innerText=warning;
  const total=passed+failed+warning;
  const ratio=total>0?passed/total:0;
  const summaryEl=document.getElementById("summary");
  summaryEl.classList.remove("text-green-500","text-yellow-400","text-red-500");
  if(ratio<0.3) summaryEl.classList.add("text-red-500");
  else if(ratio<0.7) summaryEl.classList.add("text-yellow-400");
  else summaryEl.classList.add("text-green-500");
}

// Render dashboard from auditData
auditData.forEach(pageData=>{
  const page = pageData.page;
  const rows = pageData.rows;
  const summary = pageData.summary;
  addSummaryCard(page, summary.pass, summary.fail, summary.warning);
  rows.forEach(r=>addRow(page, r.level, r.rule, r.status, r.reason, r.recommendation));
});

// Update totals
let totalPass=0,totalFail=0,totalWarning=0;
auditData.forEach(p=>{
  totalPass+=p.summary.pass;
  totalFail+=p.summary.fail;
  totalWarning+=p.summary.warning;
});
updateTotals(totalPass,totalFail,totalWarning);
</script>

</body>
</html>
