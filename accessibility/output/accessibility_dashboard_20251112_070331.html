<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessibility Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  .pass { color: #16a34a; }   /* green */
  .fail { color: #dc2626; }   /* red */
  .warning { color: #f59e0b; } /* amber */
  .summary-card { cursor: pointer; }
</style>
</head>
<body class="bg-gray-100 font-sans">
  <header class="bg-blue-600 text-white p-6 shadow-md sticky top-0 z-50">
    <h1 class="text-3xl font-bold" id="site-name">Site Accessibility Dashboard</h1>
    <p class="mt-2" id="summary">
      Summary: All Pages
      | Passed: <span id="total-pass">0</span>
      | Failed: <span id="total-fail">0</span>
      | Warnings: <span id="total-warning">0</span>
    </p>
  </header>

  <!-- Page Summary Cards -->
  <div class="flex flex-wrap gap-4 px-6 mb-4" id="summary-cards"></div>

  <!-- Filters -->
  <div class="flex space-x-4 mb-4 px-6">
    <button class="filter-btn px-4 py-2 bg-gray-300 rounded" data-filter="all">All</button>
    <button class="filter-btn px-4 py-2 bg-green-300 rounded" data-filter="pass">Passed</button>
    <button class="filter-btn px-4 py-2 bg-red-300 rounded" data-filter="fail">Failed</button>
    <button class="filter-btn px-4 py-2 bg-yellow-300 rounded" data-filter="warning">Warnings</button>
  </div>

  <!-- Audit Tables -->
  <div id="audit-tables" class="px-6 space-y-4"></div>

  <!-- Scroll-to-top button -->
  <button id="scrollTopBtn" 
          class="fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded shadow-lg hover:bg-blue-700 transition-opacity opacity-75 hover:opacity-100">
    â†‘ Top
  </button>

<script>
const tableRows = [];
const pageTables = {};
const buttons = document.querySelectorAll(".filter-btn");

// ---------------- Table Row / Per-Page Table ----------------
function addRow(page, level, rule, status, reason, recommendation) {
  if(!pageTables[page]) {
    const container = document.getElementById("audit-tables");
    const header = document.createElement("div");
    header.className = "bg-gray-200 px-4 py-2 rounded cursor-pointer shadow";
    header.innerHTML = `<h2 class="font-bold">${page}</h2>`;
    const tableDiv = document.createElement("div");
    tableDiv.className = "overflow-x-auto mt-2 hidden";
    const table = document.createElement("table");
    table.className = "min-w-full bg-white shadow rounded";
    table.innerHTML = `
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2">Level</th>
          <th class="px-4 py-2">Rule</th>
          <th class="px-4 py-2">Pass/Fail</th>
          <th class="px-4 py-2">Reason</th>
          <th class="px-4 py-2">Recommendation</th>
        </tr>
      </thead>
      <tbody></tbody>
    `;
    tableDiv.appendChild(table);
    container.appendChild(header);
    container.appendChild(tableDiv);
    header.addEventListener("click", () => tableDiv.classList.toggle("hidden"));
    pageTables[page] = table.querySelector("tbody");
  }

  const tbody = pageTables[page];
  const tr = document.createElement("tr");
  tr.className = "border-b";
  tr.dataset.status = status.toLowerCase();
  tr.dataset.page = page;
  tr.innerHTML = `
    <td class="px-4 py-2">${level}</td>
    <td class="px-4 py-2">${rule}</td>
    <td class="px-4 py-2 ${status.toLowerCase()}">${status}</td>
    <td class="px-4 py-2">${reason}</td>
    <td class="px-4 py-2">${recommendation}</td>
  `;
  tableRows.push(tr);
  tbody.appendChild(tr);
}

// ---------------- Page Summary Cards ----------------
const pageSummaries = {};
function addSummaryCard(page, passed, failed, warning) {
  pageSummaries[page] = {passed, failed, warning};
  const container = document.getElementById("summary-cards");
  const total = passed + failed + warning;
  const passRatio = total>0?passed/total:0;
  let colorClass="bg-green-400";
  if(passRatio<0.3) colorClass="bg-red-500";
  else if(passRatio<0.7) colorClass="bg-yellow-400";
  const passPercent = total>0?(passed/total*100):0;
  const failPercent = total>0?(failed/total*100):0;
  const warnPercent = total>0?(warning/total*100):0;

  const card = document.createElement("div");
  card.className="summary-card bg-white shadow p-4 rounded w-64 hover:shadow-lg";
  card.innerHTML=`
    <div class="flex justify-between items-center mb-2">
      <h3 class="font-bold text-lg">${page}</h3>
      <span class="px-2 py-1 text-white rounded ${colorClass}">Pass: ${passPercent.toFixed(0)}%</span>
    </div>
    <div class="flex h-3 mb-2 w-full rounded overflow-hidden shadow-inner">
      <div class="bg-green-500 h-full" style="width:${passPercent}%;"></div>
      <div class="bg-red-600 h-full" style="width:${failPercent}%;"></div>
      <div class="bg-yellow-400 h-full" style="width:${warnPercent}%;"></div>
    </div>
    <div class="text-sm">
      <p class="text-green-600">Passed: ${passed}</p>
      <p class="text-red-600">Failed: ${failed}</p>
      <p class="text-yellow-500">Warnings: ${warning}</p>
    </div>
  `;
  card.addEventListener("click", ()=>{
    const row = tableRows.find(r=>r.dataset.page===page);
    if(row) row.scrollIntoView({behavior:"smooth", block:"start"});
  });
  container.appendChild(card);
}

// ---------------- Filters ----------------
function updateTable(filter){
  Object.values(pageTables).forEach(tbody=>{
    Array.from(tbody.children).forEach(row=>{
      if(filter==="all"||row.dataset.status===filter) row.style.display="";
      else row.style.display="none";
    });
  });
}
buttons.forEach(btn=>{
  btn.addEventListener("click",()=>updateTable(btn.dataset.filter));
});

// ---------------- Scroll to Top ----------------
const scrollBtn=document.getElementById("scrollTopBtn");
scrollBtn.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"}));
window.addEventListener("scroll",()=>{scrollBtn.style.display=window.scrollY>200?"block":"none";});
scrollBtn.style.display="none";

// ---------------- Hero Banner Totals ----------------
function updateTotals(passed, failed, warning){
  document.getElementById("total-pass").innerText=passed;
  document.getElementById("total-fail").innerText=failed;
  document.getElementById("total-warning").innerText=warning;
  const total=passed+failed+warning;
  const ratio=total>0?passed/total:0;
  const summaryEl=document.getElementById("summary");
  summaryEl.classList.remove("text-green-500","text-yellow-400","text-red-500");
  if(ratio<0.3) summaryEl.classList.add("text-red-500");
  else if(ratio<0.7) summaryEl.classList.add("text-yellow-400");
  else summaryEl.classList.add("text-green-500");
}
</script>

</body>
</html>
